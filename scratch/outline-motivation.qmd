# Motivation

```{r}
library(naniar)
library(tidyverse)
library(ggrain)
library(tinytable)
```

## Key points

I wanted to be able to understand and communicate what I was doing

I was Frustrated by not being able express those ideas

Functions were the form of expression that I wanted

Why didn't I see that earlier? It's because functions weren't explained to me in terms of chunking/decluttering/breaking down complexity.

They were introduced as "celcius to farenheit", or "mean center a value" or "find odd numbers".

It's not that those things weren't useful

## A Story of missing data

![My first Thesis dataset: \> 60% of the data was missing](images/bmjopen-missmap.jpg)

## How missingness might impact data?

```{r}
airquality %>% 
  select(Temp,
         Solar.R) %>% 
  head() %>% 
  tt() %>% 
  style_tt(
    i = 1:4,
    j = 1:2,
    background = "teal",
    color = "white",
    bold = TRUE
  ) %>% 
  style_tt(
    i = 5:6,
    j = 1:2,
    background = "coral",
    color = "white",
    bold = TRUE
  )
```

```{r}
#| echo: false
var_missing <- airquality$Solar.R
var_interest <- airquality$Temp
which_missing <- which(is.na(var_missing))
which_complete <- which(!is.na(var_missing))

var_interest_miss <- var_interest[which_missing]
var_interest_complete <- var_interest[which_complete]

na_aq <- nabular(airquality)
ggplot(na_aq,
       aes(x = Solar.R_NA,
           y = Temp,
           fill = Solar.R_NA,
           colour = Solar.R_NA)) + 
  geom_rain(
    boxplot.args = list(color = "black"),
    violin.args = list(color = "black"),
    point.args = list(alpha = 0.5)
  ) +
  labs(
    x = ""
  ) + 
  scale_x_discrete(labels = c("Solar.R Present", "Solar.R Missing")) + 
  coord_flip() +
  scale_fill_manual(values = c("#008080", "coral")) + 
  scale_colour_manual(values = c("#008080", "coral")) + 
  ggthemes::theme_par() +
  theme(
    legend.position = "none"
  )
  
```

## A script:

```{r}
x <- na.omit(airquality$Temp[which(is.na(airquality$Solar.R))])
y <- na.omit(airquality$Temp[which(!is.na(airquality$Solar.R))])

x_mean_diff <- (x - (sum(x) / length(x)))^2
sum_x_mean_diff <- sum(x_mean_diff)
s_x <- sqrt((1 / length(x)) * sum_x_mean_diff)
se_x <- s_x / sqrt(length(x))

y_mean_diff <- (y - (sum(y) / length(y)))^2
sum_y_mean_diff <- sum(y_mean_diff)
s_x <- sqrt((1 / length(y)) * sum_y_mean_diff)
se_y <- s_x / sqrt(length(y))

numerator <- mean(x) - mean(y)
denominator <- sqrt(se_x + se_y)

result <- numerator / denominator

```

## A(n) improved script:

```{r}
var_missing <- airquality$Solar.R
var_interest <- airquality$Temp
which_missing <- which(is.na(var_missing))
which_complete <- which(!is.na(var_missing))

var_interest_miss <- var_interest[which_missing]
var_interest_complete <- var_interest[which_complete]

mean(var_interest_miss)
mean(var_interest_complete)

result <- t.test(var_interest_miss, y = var_interest_complete)

result
```

## Can I use other variables?

```{r}
var_missing <- airquality$Solar.R
var_interest <- airquality$Temp
which_missing <- which(is.na(var_missing))
which_complete <- which(!is.na(var_missing))

var_interest_miss <- var_interest[which_missing]
var_interest_complete <- var_interest[which_complete]

mean(var_interest_miss)
mean(var_interest_complete)

result <- t.test(var_interest_miss, y = var_interest_complete)

result
```
